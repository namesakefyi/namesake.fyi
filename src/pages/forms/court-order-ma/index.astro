---
import type { SanityDocument } from "@sanity/client";
import BaseLayout from "@/layouts/BaseLayout.astro";
import { loadQuery } from "@/sanity/lib/loadQuery";
import { getFormPdfMetadata } from "@/utils/getFormPdfMetadata";
import { MaCourtOrderForm } from "./_Form";

const { data: form } = await loadQuery<SanityDocument>({
  query: `*[_type == "form" && slug.current == $slug][0]{
    title,
    description,
    _updatedAt,
    state,
    category,
    "costs": *[_type == "guide" && state._ref == ^.state._ref && category._ref == ^.category._ref][0].costs
  }`,
  params: {
    slug: "court-order-ma",
  },
});

const pdfs = await getFormPdfMetadata("court-order-ma");
---

<BaseLayout title={form.title} description={form.description} color="white">
  <MaCourtOrderForm
    client:load
    title={form.title}
    description={form.description}
    updatedAt={form._updatedAt}
    pdfs={pdfs}
    costs={form.costs}
  />
</BaseLayout>
