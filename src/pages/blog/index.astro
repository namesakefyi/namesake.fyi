---
import { getCollection, getEntries } from "astro:content";
import ArticleLink from "~/components/ArticleLink.astro";
import PageHeader from "~/components/PageHeader.astro";
import BaseLayout from "~/layouts/BaseLayout.astro";

const posts = await getCollection("posts");
const sortedPosts = posts.sort(
  (a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime(),
);
---

<BaseLayout
  title="Blog"
  description="The latest news from Namesake."
  color="blue"
>
  <PageHeader title="Blog" description="The latest news from Namesake." />
  <div class="posts">
    {
      sortedPosts.length ? (
        sortedPosts.map((post) => (
          <ArticleLink
            authors={post.data.authors}
            title={post.data.title}
            date={post.data.publishDate}
            url={`/blog/${post.id}`}
            description={post.data.description}
            image={post.data.image}
            imageAlt={post.data.imageAlt}
          />
        ))
      ) : (
        <p>No posts found.</p>
      )
    }
  </div>
</BaseLayout>

<style lang="scss">
  .posts {
    display: flex;
    flex-direction: column;
    gap: var(--space-3xl);
    padding-bottom: var(--space-3xl);
  }
</style>
