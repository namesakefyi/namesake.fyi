---
import PageHeader from "@/components/PageHeader.astro";
import BaseLayout from "@/layouts/BaseLayout.astro";
import { loadQuery } from "@/sanity/lib/loadQuery";
import dayjs from "dayjs";
import utc from "dayjs/plugin/utc";
import { GuidesTable, type Guide } from "./_components/GuidesTable";

dayjs.extend(utc);

const { params } = Astro.props;

const { data: guides } = await loadQuery<Guide[]>({
  query: `*[_type == "guide" && defined(slug)]{
    title,
    slug,
    "state": state->name,
    "category": category->name,
    _updatedAt,
  } | order(publishDate desc)`,
  params,
});
---

<BaseLayout
  title="Guides"
  description="Step-by-step name change guides for identity documents."
  color="white"
>
  <PageHeader
    title="Guides"
    description="Step-by-step name change guides for identity documents."
  />
  <div class="guides">
    <GuidesTable client:load guides={guides} />
  </div>
</BaseLayout>

<style>
  .guides {
    padding-block-end: var(--space-2xl);
  }
</style>
